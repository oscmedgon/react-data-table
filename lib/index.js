"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=ReactTabularGrid;var _pathutils=require("./services/pathutils");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var _window=window,React=_window.React;function ReactTabularGrid(_ref){var data=_ref.data,options=_ref.options;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),columns=_React$useState2[0],setColumns=_React$useState2[1];React.useEffect(function(){var newColumns=Object.keys(options.columns).map(function(key){var base={name:key};if(typeof options.columns[key]==='string'){base.path=options.columns[key];base.type='string';}else if(_typeof(options.columns[key])==='object'){var _options$columns$key=options.columns[key],path=_options$columns$key.path,type=_options$columns$key.type,lock=_options$columns$key.lock;base.path=path;base.type=type;base.lock=lock;}return base;});setColumns(newColumns);},[JSON.stringify({data:data,options:options})]);return/*#__PURE__*/React.createElement(ColumnsComponent,{options:options,columns:columns,data:data});}function ColumnsComponent(_ref2){var _ref2$options=_ref2.options;_ref2$options=_ref2$options===void 0?{}:_ref2$options;var _ref2$options$icons=_ref2$options.icons;_ref2$options$icons=_ref2$options$icons===void 0?{}:_ref2$options$icons;var _ref2$options$icons$l=_ref2$options$icons.lock;_ref2$options$icons$l=_ref2$options$icons$l===void 0?{}:_ref2$options$icons$l;var _ref2$options$icons$l2=_ref2$options$icons$l.on,lockIconOn=_ref2$options$icons$l2===void 0?'fas fa-lock':_ref2$options$icons$l2,_ref2$options$icons$l3=_ref2$options$icons$l.off,lockIconOff=_ref2$options$icons$l3===void 0?'fas fa-lock-open':_ref2$options$icons$l3,data=_ref2.data,columns=_ref2.columns;var _React$useState3=React.useState(columns),_React$useState4=_slicedToArray(_React$useState3,2),config=_React$useState4[0],setConfig=_React$useState4[1];React.useEffect(function(){var currentConfig=config.map(function(el){return _objectSpread({},el);});var newConfig=columns;if(currentConfig.length===0){setConfig(newConfig);}else{var populated=currentConfig.reduce(function(acc,el){var prevColIndex=newConfig.findIndex(function(_ref3){var name=_ref3.name;return name===el.name;});if(prevColIndex===-1){return acc;}var name=el.name;var _newConfig$prevColInd=newConfig[prevColIndex],label=_newConfig$prevColInd.label,path=_newConfig$prevColInd.path,hide=_newConfig$prevColInd.hide,lock=_newConfig$prevColInd.lock;var newEl={name:name,hide:el.hide!==undefined?el.hide:hide,label:el.label!==undefined?el.label:label,lock:el.lock!==undefined?el.lock:lock,path:path};acc.push(newEl);},[]);setConfig(populated);}},[JSON.stringify({columns:columns})]);function manageToggleLock(columnName){var newConfig=config.map(function(el){if(el.name===columnName){return _objectSpread(_objectSpread({},el),{},{lock:!el.lock});}return el;});setConfig(newConfig);}function renderColumn(_ref4,columnIndex){var name=_ref4.name,path=_ref4.path,type=_ref4.type,label=_ref4.label,lock=_ref4.lock;var header=label||name;return/*#__PURE__*/React.createElement("div",{className:"tabular-column",id:header,key:"".concat(header,"-COLUMN"),"data-index":columnIndex},/*#__PURE__*/React.createElement("div",{className:"tabular-header"},/*#__PURE__*/React.createElement("span",{className:"header-label"},header),/*#__PURE__*/React.createElement("div",{className:"header-actions"},/*#__PURE__*/React.createElement("i",{className:lock?lockIconOn:lockIconOff,onClick:function onClick(){return manageToggleLock(name);}}))),data.map(function(el,index){return/*#__PURE__*/React.createElement("div",{className:"tabular-cell",key:"".concat(header,"-ROW-").concat(index)},(0,_pathutils.accessObjectByString)(path,el));}));}var lockedColumns=config.filter(function(column){return column.lock;});var unlockedColumns=config.filter(function(column){return!column.lock;});return/*#__PURE__*/React.createElement("div",{className:"tabular-container"},lockedColumns.length>=1&&/*#__PURE__*/React.createElement("div",{className:"locked-columns__container"},lockedColumns.map(renderColumn)),unlockedColumns.map(renderColumn));}